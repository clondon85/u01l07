/**
 * Made with ❤️ by Mighty — Maestro LLC
 * Copyright © 2025 Maestro LLC
 */
var d=["MIGHTY_INTERACTIVE_CORE_LOADED","MIGHTY_INTERACTIVE_HEIGHT_REPORT","MIGHTY_INTERACTIVE_POST_CORE_LOADED_REPORT","MIGHTY_INTERACTIVE_DIRECT_CODE_HTML_REQUESTED","MIGHTY_INTERACTIVE_DIRECT_CODE_HTML_REPORT","MIGHTY_INTERACTIVE_READY_TO_DISPLAY","MIGHTY_INTERACTIVE_COMPLETE","MIGHTY_INTERACTIVE_GET_ZIP_FILE","MIGHTY_INTERACTIVE_SEND_ZIP_FILE","MIGHTY_INTERACTIVE_SCREENCAP","MIGHTY_INTERACTIVE_DYNAMIC_FORM_CONFIG","MIGHTY_INTERACTIVE_RELOAD_REQUESTED","MIGHTY_INTERACTIVE_SDK_HOST_PING","MIGHTY_INTERACTIVE_SDK_HOST_PONG","MIGHTY_INTERACTIVE_SDK_STATE_REQUESTED","MIGHTY_INTERACTIVE_SDK_STATE_PROVIDED"];function E(s){return typeof s=="object"&&s!==null&&typeof s.data=="object"&&s.data!==null&&d.includes(s.data.type)}var _=["MIGHTY_INTERACTIVE_LOADED","MIGHTY_INTERACTIVE_HEIGHT_REPORT","MIGHTY_INTERACTIVE_CSS_JS_REPORT","MIGHTY_INTERACTIVE_HTML_REPORT","MIGHTY_INTERACTIVE_READY","MIGHTY_INTERACTIVE_COMPLETE","MIGHTY_INTERACTIVE_GET_ZIP_FILE","MIGHTY_INTERACTIVE_SEND_ZIP_FILE","MIGHTY_INTERACTIVE_DYNAMIC_FORM_CONFIG","MIGHTY_INTERACTIVE_RELOAD_REQUESTED","MIGHTY_INTERACTIVE_SDK_HOST_PING","MIGHTY_INTERACTIVE_SDK_HOST_PONG","MIGHTY_INTERACTIVE_SDK_STATE_REQUESTED","MIGHTY_INTERACTIVE_SDK_STATE_PROVIDED"];function M(s){return typeof s=="object"&&s!==null&&typeof s.data=="object"&&s.data!==null&&_.includes(s.data.type)}var I=class{initialize(){this.postMessageToParentWindow({type:"MIGHTY_INTERACTIVE_CORE_LOADED"}),this.listenForWhenDocumentIsReady(),this.listenForMessagesFromParent()}listenForWhenDocumentIsReady(){document.readyState==="complete"?this.onDocumentReady():document.onreadystatechange=()=>{document.readyState==="complete"&&this.onDocumentReady()}}onDocumentReady(){this.listenForWhenDocumentIsResized()}listenForWhenDocumentIsResized(){this.postMightyInteractiveHeightReport(),new ResizeObserver(()=>{this.postMightyInteractiveHeightReport()}).observe(document.documentElement)}postMightyInteractiveHeightReport(){let e=document.documentElement.getBoundingClientRect().height;this.postMessageToParentWindow({type:"MIGHTY_INTERACTIVE_HEIGHT_REPORT",data:{height:Math.ceil(e)}})}postMessageToParentWindow(e){window.parent.postMessage(e,"*")}listenForMessagesFromParent(){window.addEventListener("message",e=>{if(!E(e))return;let t=e.data;switch(t.type){case"MIGHTY_INTERACTIVE_SCREENCAP":this.onMightyInteractiveScreencapMessage(t);break;case"MIGHTY_INTERACTIVE_POST_CORE_LOADED_REPORT":this.onMightyInteractivePostCoreLoadedReportMessage(t);break}})}onMightyInteractiveScreencapMessage(e){if(e.type==="MIGHTY_INTERACTIVE_SCREENCAP"){let t=e.data.html,r=new window.DOMParser().parseFromString(t,"text/html");document.replaceChild(r.documentElement,document.documentElement)}}onMightyInteractivePostCoreLoadedReportMessage(e){if(e.type==="MIGHTY_INTERACTIVE_POST_CORE_LOADED_REPORT"){let{injectCss:t,injectJavascript:T}=e.data;this.injectCssAndJavascriptSnippets({cssSnippet:t,javascriptSnippet:T}),this.postMessageToParentWindow({type:"MIGHTY_INTERACTIVE_READY_TO_DISPLAY"})}}injectCssAndJavascriptSnippets(e){let{cssSnippet:t,javascriptSnippet:T}=e;if(t||T){if(document.querySelector("#mightyInteractiveOverrideCss")?.remove(),document.querySelector("#mightyInteractiveOverrideJavascript")?.remove(),t){let r=document.createElement("style");r.id="mightyInteractiveOverrideCss",r.innerHTML=t,document.body.appendChild(r)}if(T){let r=document.createElement("script");r.id="mightyInteractiveOverrideJavascript",r.innerHTML=T,document.body.appendChild(r)}}}};var a=class{constructor(){this.messageHandlers=new Map,this.listenToPostMessagesRelatedToSDK()}onMessageReceived(e,t){return this.messageHandlers.has(e)||this.messageHandlers.set(e,new Set),this.messageHandlers.get(e)?.add(t),()=>{this.messageHandlers.get(e)?.delete(t)}}sendHostPingMessage(){this.postMessageToInteractiveBlockWindow({type:"MIGHTY_INTERACTIVE_SDK_HOST_PING"})}sendStateRequestedMessage(e){this.postMessageToInteractiveBlockWindow({type:"MIGHTY_INTERACTIVE_SDK_STATE_REQUESTED",data:{defaultState:e}})}sendMarkAsCompleteMessage(){this.postMessageToInteractiveBlockWindow({type:"MIGHTY_INTERACTIVE_COMPLETE"})}listenToPostMessagesRelatedToSDK(){window.addEventListener("message",e=>{if(M(e)){let t=e.data.type;switch(t){case"MIGHTY_INTERACTIVE_SDK_HOST_PONG":this.handleMessageReceived(t,e.data.data);break;case"MIGHTY_INTERACTIVE_SDK_STATE_PROVIDED":this.handleMessageReceived(t,e.data.data.state);break}}})}postMessageToInteractiveBlockWindow(e){window.parent!==window&&window.parent.postMessage(e,"*")}handleMessageReceived(e,t){let T=this.messageHandlers.get(e);T&&T.forEach(r=>{r(t??void 0)})}};var i=class{getState(e,t){return Promise.resolve(e)}};var o=class{constructor(e){this.messenger=e}async getState(e){return new Promise((t,T)=>{let p=setTimeout(()=>{T(new Error("Interactive state not provided in time"))},5e3);this.messenger.onMessageReceived("MIGHTY_INTERACTIVE_SDK_STATE_PROVIDED",R=>{clearTimeout(p),t(R)}),this.messenger.sendStateRequestedMessage(e)})}};var n=class{constructor(){this.version="0.0.1";this.sdkIsReady=!1,this.messenger=new a,this.useNoOpMode=!1}async initialize(){await this.checkForHost()||(this.useNoOpMode=!0),this.useNoOpMode?this.state=new i:this.state=new o(this.messenger),this.sdkIsReady=!0,this.sdkReadyFn?.()}onSdkReady(e){this.sdkReadyFn=e,this.sdkIsReady&&e()}markAsComplete(){this.messenger.sendMarkAsCompleteMessage()}checkForHost(){return new Promise(e=>{this.messenger.onMessageReceived("MIGHTY_INTERACTIVE_SDK_HOST_PONG",t=>{t&&t.courseId&&t.blockId&&(this.courseId=t.courseId,this.blockId=t.blockId),e(!0)}),setTimeout(()=>{this.messenger.sendHostPingMessage(),setTimeout(()=>{e(!1)},100)},0)})}};var c=new n;window.mightyInteractiveSdk=c;c.initialize();var g=new I;g.initialize();
